<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ColorSocial - –ü–æ–ª–Ω–∞—è —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6C63FF;
            --secondary: #FF6584;
            --success: #4CAF50;
            --warning: #FF9800;
            --info: #2196F3;
            --danger: #E53E3E;
            --gradient: linear-gradient(135deg, #6C63FF 0%, #FF6584 100%);
            --gradient-2: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-3: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --dark: #2D3748;
            --light: #F7FAFC;
            --text: #4A5568;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            color: var(--text);
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-radius: 0 0 20px 20px;
            margin-bottom: 20px;
        }

        .nav-brand {
            font-size: 1.8em;
            font-weight: bold;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-badge {
            background: var(--danger);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.6em;
            margin-left: 5px;
        }

        .nav-menu {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .nav-item {
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-item:hover {
            background: var(--gradient);
            color: white;
            transform: translateY(-2px);
        }

        .nav-item.active {
            background: var(--gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.4);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 16px;
            border: 3px solid white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            display: flex;
            gap: 20px;
            flex: 1;
            padding: 0 20px 20px;
        }

        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }

        /* –§–æ—Ä–º—ã */
        .auth-container {
            max-width: 450px;
            margin: 50px auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(15px);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-title {
            font-size: 2em;
            margin-bottom: 10px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .auth-subtitle {
            color: var(--text);
            opacity: 0.8;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            font-weight: 600;
            color: var(--dark);
        }

        input, textarea, select {
            padding: 15px;
            border: 2px solid #E2E8F0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(108, 99, 255, 0.4);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--text);
            border: 2px solid #E2E8F0;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .form-switch {
            text-align: center;
            margin-top: 25px;
            color: var(--text);
        }

        .switch-link {
            color: var(--primary);
            cursor: pointer;
            font-weight: 600;
        }

        /* –ü–æ–∏—Å–∫ */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 15px 45px 15px 15px;
            border: 2px solid #E2E8F0;
            border-radius: 12px;
            font-size: 16px;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #718096;
        }

        /* –°–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
        .users-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #F7FAFC;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .user-item:hover {
            background: #EDF2F7;
            transform: translateX(5px);
        }

        .user-avatar-small {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 600;
            color: var(--dark);
        }

        .user-email {
            font-size: 0.8em;
            color: #718096;
        }

        .user-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —á–∞—Ç–æ–≤ */
        .chats-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .chat-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #F7FAFC;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .chat-item:hover {
            background: #EDF2F7;
            transform: translateX(5px);
        }

        .chat-info {
            flex: 1;
        }

        .chat-partner-name {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 5px;
        }

        .last-message {
            font-size: 0.9em;
            color: #718096;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .chat-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 5px;
        }

        .last-time {
            font-size: 0.8em;
            color: #A0AEC0;
        }

        .unread-badge {
            background: var(--primary);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: 600;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–∫–Ω–∞ —á–∞—Ç–∞ */
        .chat-header {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 20px;
            border-bottom: 1px solid #E2E8F0;
            margin-bottom: 20px;
        }

        .chat-partner-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .user-status {
            font-size: 0.8em;
            color: var(--success);
        }

        .chat-messages {
            height: 400px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
            padding: 10px;
        }

        .message {
            display: flex;
            max-width: 70%;
            position: relative;
        }

        .own-message {
            align-self: flex-end;
        }

        .own-message .message-content {
            background: var(--gradient);
            color: white;
        }

        .partner-message .message-content {
            background: #F7FAFC;
            color: var(--text);
        }

        .group-message .message-content {
            background: #EBF8FF;
            color: var(--text);
        }

        .message-content {
            padding: 12px 15px;
            border-radius: 18px;
            position: relative;
        }

        .message-sender {
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .message-text {
            margin-bottom: 5px;
            line-height: 1.4;
        }

        .message-time {
            font-size: 0.7em;
            opacity: 0.7;
            text-align: right;
        }

        .message-actions {
            position: absolute;
            top: -10px;
            right: 5px;
            display: none;
            gap: 5px;
        }

        .message:hover .message-actions {
            display: flex;
        }

        .message-action-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #E2E8F0;
            border-radius: 25px;
            font-size: 14px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≥—Ä—É–ø–ø */
        .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }

        .group-card {
            background: #F7FAFC;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .group-card:hover {
            background: #EDF2F7;
            transform: translateY(-5px);
        }

        .group-avatar-large {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .group-info h4 {
            margin: 0 0 10px 0;
            color: var(--dark);
        }

        .group-info p {
            color: #718096;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .group-meta {
            display: flex;
            gap: 15px;
            font-size: 0.8em;
            color: #A0AEC0;
        }

        .user-select-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #F7FAFC;
            border-radius: 8px;
            margin-bottom: 5px;
        }

        .user-select-item label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            margin: 0;
            flex: 1;
        }

        .group-info-header {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
        }

        .group-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        /* –ñ–∞–ª–æ–±—ã */
        .complaint-item {
            background: #F7FAFC;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--warning);
        }

        .complaint-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .complaint-meta {
            display: flex;
            gap: 15px;
            color: #718096;
            font-size: 0.8em;
            margin-bottom: 10px;
        }

        .complaint-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å */
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--gradient);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        /* –≠–º–æ–¥–∑–∏ –ø–∞–Ω–µ–ª—å */
        .emoji-panel {
            position: absolute;
            background: white;
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 300px;
            display: none;
            flex-wrap: wrap;
            gap: 8px;
        }

        .emoji-category {
            width: 100%;
            margin-bottom: 10px;
        }

        .category-title {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        .emoji-item {
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .emoji-item:hover {
            background: var(--light);
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ */
        .image-upload-container {
            margin: 15px 0;
        }

        .image-preview {
            max-width: 100%;
            max-height: 300px;
            border-radius: 15px;
            margin-top: 10px;
            display: none;
        }

        .upload-btn {
            background: var(--gradient-2);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }

        /* –ì–∞–ª–µ—Ä–µ—è */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .gallery-item {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            aspect-ratio: 1;
            cursor: pointer;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .gallery-item:hover img {
            transform: scale(1.1);
        }

        /* –ê—Ä—Ö–∏–≤ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ */
        .accounts-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .account-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #F7FAFC;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .account-item:hover {
            background: #EDF2F7;
            transform: translateX(5px);
        }

        .account-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .account-info {
            flex: 1;
        }

        .account-name {
            font-weight: 600;
            color: var(--dark);
        }

        .account-email {
            font-size: 0.8em;
            color: #718096;
        }

        /* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ */
        .support-ticket {
            background: #F7FAFC;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }

        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .ticket-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .status-open {
            background: #C6F6D5;
            color: #276749;
        }

        .status-closed {
            background: #FED7D7;
            color: #C53030;
        }

        .status-pending {
            background: #FEFCBF;
            color: #744210;
        }

        .ticket-date {
            color: #718096;
            font-size: 0.8em;
        }

        /* –õ–µ–Ω—Ç–∞ –∏ –ø–æ—Å—Ç—ã */
        .create-post-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
        }

        .post-header {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            margin-bottom: 15px;
        }

        .post-textarea {
            flex: 1;
            min-height: 80px;
            resize: none;
            font-family: inherit;
            border: 2px solid #E2E8F0;
            border-radius: 15px;
            padding: 15px;
        }

        .post-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .icon-btn {
            background: none;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text);
            transition: all 0.3s;
        }

        .icon-btn:hover {
            background: var(--light);
            transform: translateY(-1px);
        }

        .report-btn {
            color: var(--danger);
        }

        .post-button {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .post-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(108, 99, 255, 0.4);
        }

        /* –ü–æ—Å—Ç—ã */
        .post-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
            transition: transform 0.3s;
            position: relative;
        }

        .post-card:hover {
            transform: translateY(-5px);
        }

        .post-user {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .user-info h4 {
            margin: 0;
            color: var(--dark);
            font-size: 1.1em;
        }

        .username {
            color: var(--primary);
            font-size: 0.9em;
            font-weight: 500;
        }

        .post-time {
            color: #A0AEC0;
            font-size: 0.8em;
        }

        .post-content {
            margin: 20px 0;
            line-height: 1.6;
            color: var(--text);
            font-size: 1.1em;
        }

        .post-image {
            width: 100%;
            border-radius: 15px;
            margin: 15px 0;
            max-height: 400px;
            object-fit: cover;
        }

        .post-stats {
            display: flex;
            gap: 20px;
            color: #718096;
            font-size: 0.9em;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #E2E8F0;
        }

        .post-actions-buttons {
            display: flex;
            gap: 10px;
        }

        .action-button {
            background: none;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .like-button {
            color: #718096;
        }

        .like-button.liked {
            color: #E53E3E;
            background: #FED7D7;
        }

        .comment-button {
            color: #718096;
        }

        .comment-button.active {
            color: var(--primary);
            background: #EBF4FF;
        }

        /* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ */
        .comments-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #E2E8F0;
        }

        .comment-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .comment-form input {
            flex: 1;
        }

        .comment {
            display: flex;
            gap: 12px;
            margin-bottom: 15px;
            padding: 15px;
            background: #F7FAFC;
            border-radius: 15px;
        }

        .comment-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--gradient-2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .comment-header strong {
            font-size: 0.9em;
            color: var(--dark);
        }

        .comment-header span {
            font-size: 0.8em;
            color: #A0AEC0;
        }

        .comment-content p {
            font-size: 0.9em;
            color: var(--text);
            margin: 0;
            line-height: 1.5;
        }

        /* –í–∏–¥–∂–µ—Ç—ã —Å–∞–π–¥–±–∞—Ä–∞ */
        .widget {
            margin-bottom: 25px;
        }

        .widget-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .user-stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
            margin: 20px 0;
        }

        .stat {
            display: flex;
            flex-direction: column;
        }

        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8em;
            color: #718096;
        }

        .trending-topics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .topic {
            padding: 10px 15px;
            background: #F7FAFC;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .topic:hover {
            background: #EDF2F7;
            transform: translateX(5px);
        }

        /* –°—Ç—Ä–∞–Ω–∏—Ü—ã */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .profile-header {
            text-align: center;
            padding: 40px 0;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2em;
            font-weight: bold;
            margin: 0 auto 15px;
            border: 5px solid white;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #718096;
        }

        .error {
            background: #FED7D7;
            color: #C53030;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .success {
            background: #C6F6D5;
            color: #2D3748;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .no-posts {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .blocked-account {
            opacity: 0.6;
            background: #FED7D7 !important;
        }

        .blocked-badge {
            background: var(--danger);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            margin-left: 5px;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1024px) {
            .app-container {
                padding: 0 10px;
            }
            
            .navbar {
                padding: 15px 20px;
                flex-wrap: wrap;
            }
            
            .nav-menu {
                order: 3;
                width: 100%;
                justify-content: center;
                margin-top: 15px;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .nav-item {
                padding: 8px 15px;
                font-size: 0.9em;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                padding: 0 10px 20px;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
            }
            
            .content-area {
                order: 1;
            }
            
            .nav-menu {
                display: none;
            }
            
            .mobile-menu-btn {
                display: block !important;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .emoji-panel {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                max-width: none;
                border-radius: 20px 20px 0 0;
            }
            
            .message {
                max-width: 85%;
            }
            
            .user-actions {
                flex-direction: column;
                gap: 5px;
            }
            
            .action-btn {
                font-size: 10px;
                padding: 6px 8px;
            }
            
            .admin-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .groups-grid {
                grid-template-columns: 1fr;
            }
            
            .gallery-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .chat-messages {
                height: 300px;
            }
            
            .post-actions {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .post-actions-buttons {
                flex-wrap: wrap;
            }
            
            .action-button {
                padding: 8px 15px;
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            .auth-container {
                margin: 20px auto;
                padding: 25px;
            }
            
            .auth-title {
                font-size: 1.5em;
            }
            
            .navbar {
                padding: 10px 15px;
            }
            
            .nav-brand {
                font-size: 1.4em;
            }
            
            .user-avatar {
                width: 35px;
                height: 35px;
                font-size: 14px;
            }
            
            .card {
                padding: 20px;
            }
            
            .admin-stats {
                grid-template-columns: 1fr;
            }
            
            .gallery-grid {
                grid-template-columns: 1fr;
            }
            
            .complaint-actions {
                flex-direction: column;
            }
            
            .user-stats {
                flex-direction: column;
                gap: 15px;
            }
        }

        /* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 1.5em;
            color: var(--primary);
            cursor: pointer;
        }

        .mobile-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.98);
            z-index: 1000;
            display: none;
            flex-direction: column;
            padding: 80px 30px 30px;
            overflow-y: auto;
        }

        .mobile-menu.active {
            display: flex;
        }

        .mobile-menu-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 1.5em;
            color: var(--primary);
            cursor: pointer;
        }

        .mobile-nav-item {
            padding: 15px 20px;
            border-radius: 15px;
            margin-bottom: 10px;
            font-size: 1.1em;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
        }

        .mobile-nav-item.active {
            background: var(--gradient);
            color: white;
        }

        .mobile-nav-item:hover {
            background: var(--gradient);
            color: white;
            transform: translateX(10px);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <div class="navbar hidden" id="navbar">
            <div class="nav-brand">
                <i class="fas fa-heart"></i>
                ColorSocial
                <span class="admin-badge hidden" id="adminBadge">ADMIN</span>
            </div>
            
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
            
            <div class="nav-menu">
                <div class="nav-item active" onclick="showPage('feed')">
                    <i class="fas fa-home"></i>
                    –õ–µ–Ω—Ç–∞
                </div>
                <div class="nav-item" onclick="showPage('profile')">
                    <i class="fas fa-user"></i>
                    –ü—Ä–æ—Ñ–∏–ª—å
                </div>
                <div class="nav-item" onclick="showPage('friends')">
                    <i class="fas fa-users"></i>
                    –î—Ä—É–∑—å—è
                </div>
                <div class="nav-item" onclick="showPage('chats')">
                    <i class="fas fa-comments"></i>
                    –ß–∞—Ç—ã
                </div>
                <div class="nav-item" onclick="showPage('groups')">
                    <i class="fas fa-user-friends"></i>
                    –ì—Ä—É–ø–ø—ã
                </div>
                <div class="nav-item" onclick="showPage('gallery')">
                    <i class="fas fa-images"></i>
                    –ì–∞–ª–µ—Ä–µ—è
                </div>
                <div class="nav-item" onclick="showPage('archive')">
                    <i class="fas fa-archive"></i>
                    –ê—Ä—Ö–∏–≤
                </div>
                <div class="nav-item" onclick="showPage('support')">
                    <i class="fas fa-headset"></i>
                    –ü–æ–¥–¥–µ—Ä–∂–∫–∞
                </div>
                <div class="nav-item hidden" id="adminNavItem" onclick="showPage('admin')">
                    <i class="fas fa-shield-alt"></i>
                    –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </div>
            </div>
            <div class="user-section">
                <div class="user-avatar" id="userAvatar">U</div>
                <button class="btn btn-secondary" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    –í—ã–π—Ç–∏
                </button>
            </div>
        </div>

        <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
        <div class="mobile-menu" id="mobileMenu">
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
            <div class="mobile-nav-item active" onclick="showPage('feed'); closeMobileMenu()">
                <i class="fas fa-home"></i>
                –õ–µ–Ω—Ç–∞
            </div>
            <div class="mobile-nav-item" onclick="showPage('profile'); closeMobileMenu()">
                <i class="fas fa-user"></i>
                –ü—Ä–æ—Ñ–∏–ª—å
            </div>
            <div class="mobile-nav-item" onclick="showPage('friends'); closeMobileMenu()">
                <i class="fas fa-users"></i>
                –î—Ä—É–∑—å—è
            </div>
            <div class="mobile-nav-item" onclick="showPage('chats'); closeMobileMenu()">
                <i class="fas fa-comments"></i>
                –ß–∞—Ç—ã
            </div>
            <div class="mobile-nav-item" onclick="showPage('groups'); closeMobileMenu()">
                <i class="fas fa-user-friends"></i>
                –ì—Ä—É–ø–ø—ã
            </div>
            <div class="mobile-nav-item" onclick="showPage('gallery'); closeMobileMenu()">
                <i class="fas fa-images"></i>
                –ì–∞–ª–µ—Ä–µ—è
            </div>
            <div class="mobile-nav-item" onclick="showPage('archive'); closeMobileMenu()">
                <i class="fas fa-archive"></i>
                –ê—Ä—Ö–∏–≤
            </div>
            <div class="mobile-nav-item" onclick="showPage('support'); closeMobileMenu()">
                <i class="fas fa-headset"></i>
                –ü–æ–¥–¥–µ—Ä–∂–∫–∞
            </div>
            <div class="mobile-nav-item hidden" id="mobileAdminNavItem" onclick="showPage('admin'); closeMobileMenu()">
                <i class="fas fa-shield-alt"></i>
                –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
            </div>
        </div>

        <!-- –≠–º–æ–¥–∑–∏ –ø–∞–Ω–µ–ª—å -->
        <div class="emoji-panel" id="emojiPanel"></div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ -->
        <div class="auth-container" id="loginPage">
            <div class="auth-header">
                <h1 class="auth-title">–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!</h1>
                <p class="auth-subtitle">–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç</p>
            </div>
            
            <!-- –ê—Ä—Ö–∏–≤ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ -->
            <div class="accounts-list" id="savedAccounts" style="margin-bottom: 20px;"></div>

            <form class="auth-form" onsubmit="login(event)">
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="loginPassword" required placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <div class="form-group" style="flex-direction: row; align-items: center; gap: 10px;">
                    <input type="checkbox" id="rememberMe" checked>
                    <label for="rememberMe" style="margin: 0;">–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è</label>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i>
                    –í–æ–π—Ç–∏
                </button>
            </form>
            <div class="form-switch">
                –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <span class="switch-link" onclick="showRegister()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</span>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div class="auth-container hidden" id="registerPage">
            <div class="auth-header">
                <h1 class="auth-title">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å!</h1>
                <p class="auth-subtitle">–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç</p>
            </div>
            <form class="auth-form" onsubmit="register(event)">
                <div class="grid-2">
                    <div class="form-group">
                        <label>–ò–º—è:</label>
                        <input type="text" id="regFirstName" required placeholder="–í–∞—à–µ –∏–º—è">
                    </div>
                    <div class="form-group">
                        <label>–§–∞–º–∏–ª–∏—è:</label>
                        <input type="text" id="regLastName" required placeholder="–í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è">
                    </div>
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="regEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" id="regPassword" required placeholder="–ù–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤">
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-plus"></i>
                    –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è
                </button>
            </form>
            <div class="form-switch">
                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <span class="switch-link" onclick="showLogin()">–í–æ–π—Ç–∏</span>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç (–ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞) -->
        <div class="main-content hidden" id="mainContent">
            <!-- –°–∞–π–¥–±–∞—Ä -->
            <div class="sidebar">
                <div class="widget">
                    <div class="user-stats">
                        <div class="stat">
                            <div class="stat-number" id="statPosts">0</div>
                            <div class="stat-label">–ü–æ—Å—Ç—ã</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="statPhotos">0</div>
                            <div class="stat-label">–§–æ—Ç–æ</div>
                        </div>
                        <div class="stat">
                            <div class="stat-number" id="statLikes">0</div>
                            <div class="stat-label">–õ–∞–π–∫–∏</div>
                        </div>
                    </div>
                </div>

                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-fire"></i>
                        –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ
                    </div>
                    <div class="trending-topics">
                        <div class="topic">#–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è üåç</div>
                        <div class="topic">#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ üíª</div>
                        <div class="topic">#–∏—Å–∫—É—Å—Å—Ç–≤–æ üé®</div>
                        <div class="topic">#—Å–ø–æ—Ä—Ç ‚öΩ</div>
                        <div class="topic">#–º—É–∑—ã–∫–∞ üéµ</div>
                    </div>
                </div>

                <div class="widget">
                    <div class="widget-title">
                        <i class="fas fa-info-circle"></i>
                        –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                    </div>
                    <p style="font-size: 0.9em; color: #718096; line-height: 1.5;">
                        ColorSocial - –≤–∞—à–∞ —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å —Å —á–∞—Ç–∞–º–∏, –≥—Ä—É–ø–ø–∞–º–∏ –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é! üéâ
                    </p>
                </div>
            </div>

            <!-- –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
            <div class="content-area">
                <!-- –õ–µ–Ω—Ç–∞ -->
                <div class="page active" id="feedPage">
                    <div class="create-post-card">
                        <div class="post-header">
                            <div class="user-avatar" id="currentUserAvatar">U</div>
                            <textarea 
                                class="post-textarea" 
                                id="postContent" 
                                placeholder="–ß—Ç–æ —É –≤–∞—Å –Ω–æ–≤–æ–≥–æ? –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏! üòä"
                                maxlength="2000"
                            ></textarea>
                        </div>
                        
                        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ -->
                        <div class="image-upload-container">
                            <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                            <div class="upload-btn" onclick="document.getElementById('imageUpload').click()">
                                <i class="fas fa-camera"></i>
                                –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ
                            </div>
                            <img id="imagePreview" class="image-preview" alt="–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä">
                        </div>

                        <div class="post-actions">
                            <div class="action-buttons">
                                <button class="icon-btn" onclick="showEmojiPanel()">
                                    <i class="fas fa-smile"></i>
                                    –≠–º–æ–¥–∑–∏
                                </button>
                                <button class="icon-btn" onclick="addRussianEmoji('üòÇ')">
                                    üòÇ
                                </button>
                                <button class="icon-btn" onclick="addRussianEmoji('‚ù§Ô∏è')">
                                    ‚ù§Ô∏è
                                </button>
                                <button class="icon-btn" onclick="addRussianEmoji('üî•')">
                                    üî•
                                </button>
                            </div>
                            <button class="post-button" onclick="createPost()">
                                <i class="fas fa-paper-plane"></i>
                                –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>

                    <div id="postsContainer">
                        <div class="no-posts">
                            <i class="fas fa-newspaper" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                            <h3>–õ–µ–Ω—Ç–∞ –ø—É—Å—Ç–∞</h3>
                            <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç! ‚ú®</p>
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
                <div class="page" id="profilePage">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileUserAvatar">U</div>
                        <h1 id="profileUserName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h1>
                        <p id="profileUserEmail">user@example.com</p>
                        <div class="user-stats" style="max-width: 400px; margin: 20px auto;">
                            <div class="stat">
                                <div class="stat-number" id="profileStatPosts">0</div>
                                <div class="stat-label">–ü–æ—Å—Ç—ã</div>
                            </div>
                            <div class="stat">
                                <div class="stat-number" id="profileStatPhotos">0</div>
                                <div class="stat-label">–§–æ—Ç–æ</div>
                            </div>
                            <div class="stat">
                                <div class="stat-number" id="profileStatLikes">0</div>
                                <div class="stat-label">–õ–∞–π–∫–∏</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 style="margin-bottom: 15px;">–û —Å–µ–±–µ</h3>
                        <p id="profileBio">–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ —Å–µ–±–µ... üìù</p>
                        <button class="btn btn-secondary" style="margin-top: 15px;" onclick="editProfile()">
                            <i class="fas fa-edit"></i>
                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                        </button>
                    </div>

                    <h3 style="margin: 20px 0 10px;">–ú–æ–∏ –ø–æ—Å—Ç—ã</h3>
                    <div id="profilePostsContainer">
                        <!-- –ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                    </div>
                </div>

                <!-- –ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π -->
                <div class="page" id="friendsPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">–ü–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π üë•</h2>
                        
                        <div class="search-container">
                            <input type="text" id="friendSearch" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email...">
                            <i class="fas fa-search search-icon"></i>
                        </div>

                        <div id="searchResults" class="users-list">
                            <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
                        </div>

                        <h3 style="margin: 30px 0 15px;">–ú–æ–∏ –¥—Ä—É–∑—å—è</h3>
                        <div id="friendsList" class="users-list">
                            <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π -->
                        </div>
                    </div>
                </div>

                <!-- –ß–∞—Ç—ã -->
                <div class="page" id="chatsPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">üí¨ –ú–æ–∏ —á–∞—Ç—ã</h2>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="chatSearch" class="search-input" placeholder="–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤...">
                            <i class="fas fa-search search-icon"></i>
                        </div>

                        <div class="chats-list" id="chatsList">
                            <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ -->
                        </div>

                        <button class="btn btn-primary" onclick="startNewChat()" style="margin-top: 20px;">
                            <i class="fas fa-plus"></i>
                            –ù–æ–≤—ã–π —á–∞—Ç
                        </button>
                    </div>
                </div>

                <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —á–∞—Ç–∞ -->
                <div class="page" id="chatPage">
                    <div class="card">
                        <div class="chat-header">
                            <button class="btn btn-secondary" onclick="showPage('chats')">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <div class="chat-partner-info">
                                <div class="user-avatar-small" id="chatPartnerAvatar">U</div>
                                <div>
                                    <div class="user-name" id="chatPartnerName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                                    <div class="user-status" id="chatPartnerStatus">–≤ —Å–µ—Ç–∏</div>
                                </div>
                            </div>
                            <button class="btn btn-secondary" onclick="blockUserForMe(currentChat)">
                                <i class="fas fa-ban"></i>
                            </button>
                        </div>

                        <div class="chat-messages" id="chatMessages">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ -->
                        </div>

                        <div class="chat-input-container">
                            <input type="text" id="chatMessageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="chat-input">
                            <button class="btn btn-primary" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ì—Ä—É–ø–ø—ã -->
                <div class="page" id="groupsPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">üë• –ì—Ä—É–ø–ø—ã</h2>
                        
                        <button class="btn btn-primary" onclick="showCreateGroupForm()" style="margin-bottom: 20px;">
                            <i class="fas fa-plus"></i>
                            –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
                        </button>

                        <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã -->
                        <div id="createGroupForm" class="hidden">
                            <h3 style="margin-bottom: 15px;">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É</h3>
                            <form onsubmit="createGroup(event)">
                                <div class="form-group">
                                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã:</label>
                                    <input type="text" id="groupName" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã">
                                </div>
                                <div class="form-group">
                                    <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                                    <textarea id="groupDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>–£—á–∞—Å—Ç–Ω–∏–∫–∏:</label>
                                    <div id="groupMembersSelect" class="users-list">
                                        <!-- –°–ø–∏—Å–æ–∫ –¥—Ä—É–∑–µ–π –¥–ª—è –≤—ã–±–æ—Ä–∞ -->
                                    </div>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-users"></i>
                                        –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="hideCreateGroupForm()">
                                        –û—Ç–º–µ–Ω–∞
                                    </button>
                                </div>
                            </form>
                        </div>

                        <h3 style="margin: 30px 0 15px;">–ú–æ–∏ –≥—Ä—É–ø–ø—ã</h3>
                        <div id="groupsList" class="groups-grid">
                            <!-- –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø -->
                        </div>
                    </div>
                </div>

                <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ -->
                <div class="page" id="groupChatPage">
                    <div class="card">
                        <div class="chat-header">
                            <button class="btn btn-secondary" onclick="showPage('groups')">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <div class="group-info-header">
                                <div class="group-avatar" id="groupChatAvatar">G</div>
                                <div>
                                    <div class="user-name" id="groupChatName">–ì—Ä—É–ø–ø–∞</div>
                                    <div class="user-status" id="groupChatMembers">0 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                                </div>
                            </div>
                            <button class="btn btn-secondary" onclick="showGroupInfo()">
                                <i class="fas fa-info-circle"></i>
                            </button>
                        </div>

                        <div class="chat-messages" id="groupChatMessages">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ -->
                        </div>

                        <div class="chat-input-container">
                            <input type="text" id="groupMessageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." class="chat-input">
                            <button class="btn btn-primary" onclick="sendGroupMessage()">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –ì–∞–ª–µ—Ä–µ—è -->
                <div class="page" id="galleryPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">–ú–æ—è –≥–∞–ª–µ—Ä–µ—è üì∏</h2>
                        <div id="userGallery" class="gallery-grid">
                            <!-- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                        </div>
                    </div>
                </div>

                <!-- –ê—Ä—Ö–∏–≤ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ -->
                <div class="page" id="archivePage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">–ê—Ä—Ö–∏–≤ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ üóÇÔ∏è</h2>
                        <p style="margin-bottom: 20px; color: #718096;">
                            –í—ã –º–æ–∂–µ—Ç–µ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ üîÑ
                        </p>
                        <div class="accounts-list" id="archiveAccountsList">
                            <!-- –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã -->
                        </div>
                    </div>
                </div>

                <!-- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ -->
                <div class="page" id="supportPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">–¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ üõ†Ô∏è</h2>
                        
                        <div class="support-actions" style="margin-bottom: 30px;">
                            <button class="btn btn-primary" onclick="showCreateTicketForm()">
                                <i class="fas fa-plus"></i>
                                –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ
                            </button>
                        </div>

                        <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è -->
                        <div id="createTicketForm" class="hidden">
                            <h3 style="margin-bottom: 15px;">–ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ</h3>
                            <form onsubmit="createSupportTicket(event)">
                                <div class="form-group">
                                    <label>–¢–µ–º–∞:</label>
                                    <input type="text" id="ticketSubject" required placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É">
                                </div>
                                <div class="form-group">
                                    <label>–¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã:</label>
                                    <select id="ticketType" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                        <option value="technical">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞</option>
                                        <option value="account">–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º</option>
                                        <option value="content">–ñ–∞–ª–æ–±–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç</option>
                                        <option value="suggestion">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</option>
                                        <option value="other">–î—Ä—É–≥–æ–µ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                                    <textarea id="ticketDescription" required placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—à–∏—Ç–µ –≤–∞—à—É –ø—Ä–æ–±–ª–µ–º—É..." rows="4"></textarea>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-paper-plane"></i>
                                        –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="hideCreateTicketForm()">
                                        –û—Ç–º–µ–Ω–∞
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- –°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π -->
                        <div id="supportTicketsList">
                            <h3 style="margin: 30px 0 15px;">–ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</h3>
                            <div id="ticketsContainer">
                                <!-- –û–±—Ä–∞—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                            </div>
                        </div>

                        <!-- –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã -->
                        <div style="margin-top: 40px;">
                            <h3 style="margin-bottom: 20px;">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã ‚ùì</h3>
                            <div class="support-ticket">
                                <h4>–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å?</h4>
                                <p>–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. üõ†Ô∏è</p>
                            </div>
                            <div class="support-ticket">
                                <h4>–ü–æ—á–µ–º—É –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ñ–æ—Ç–æ?</h4>
                                <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG) –∏ —Ä–∞–∑–º–µ—Ä (–Ω–µ –±–æ–ª–µ–µ 5MB). üì∑</p>
                            </div>
                            <div class="support-ticket">
                                <h4>–ö–∞–∫ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</h4>
                                <p>–ù–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å —Ç–µ–º–æ–π "–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞". üóëÔ∏è</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
                <div class="page" id="adminPage">
                    <div class="card">
                        <h2 style="margin-bottom: 20px;">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å üõ°Ô∏è</h2>
                        
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                        <div class="admin-stats">
                            <div class="stat-card">
                                <div class="stat-number" id="adminTotalUsers">0</div>
                                <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="adminBlockedUsers">0</div>
                                <div class="stat-label">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="adminTotalPosts">0</div>
                                <div class="stat-label">–ü–æ—Å—Ç–æ–≤</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="adminTotalComplaints">0</div>
                                <div class="stat-label">–ñ–∞–ª–æ–±</div>
                            </div>
                        </div>

                        <!-- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                        <div class="search-container" style="margin-bottom: 25px;">
                            <input type="text" id="adminUserSearch" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...">
                            <i class="fas fa-search search-icon"></i>
                        </div>

                        <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                        <h3 style="margin-bottom: 15px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                        <div id="adminUsersList" class="users-list">
                            <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –∞–¥–º–∏–Ω–∞ -->
                        </div>

                        <!-- –ñ–∞–ª–æ–±—ã -->
                        <h3 style="margin: 30px 0 15px;">–ñ–∞–ª–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π üö®</h3>
                        <div id="adminComplaintsList">
                            <!-- –°–ø–∏—Å–æ–∫ –∂–∞–ª–æ–± -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
        let users = JSON.parse(localStorage.getItem('social_users')) || [];
        let posts = JSON.parse(localStorage.getItem('social_posts')) || [];
        let currentUser = JSON.parse(localStorage.getItem('current_user')) || null;
        let savedAccounts = JSON.parse(localStorage.getItem('saved_accounts')) || [];
        let userImages = JSON.parse(localStorage.getItem('user_images')) || {};
        let supportTickets = JSON.parse(localStorage.getItem('support_tickets')) || [];
        let friends = JSON.parse(localStorage.getItem('user_friends')) || {};
        let complaints = JSON.parse(localStorage.getItem('user_complaints')) || [];
        let blockedUsers = JSON.parse(localStorage.getItem('blocked_users')) || [];
        let chats = JSON.parse(localStorage.getItem('user_chats')) || {};
        let groups = JSON.parse(localStorage.getItem('user_groups')) || {};
        let blockedForMe = JSON.parse(localStorage.getItem('blocked_for_me')) || {};
        let currentChat = null;
        let currentGroup = null;

        // –ê–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç
        const ADMIN_EMAIL = 's8807710@gmail.com';

        // –†—É—Å—Å–∫–∏–µ —ç–º–æ–¥–∑–∏
        const russianEmojis = {
            '–≠–º–æ—Ü–∏–∏': ['üòÇ', '‚ù§Ô∏è', 'üòç', 'ü§£', 'üòä', 'üéâ', 'üòÅ', 'üî•', 'üíï', 'üòé', '‚ú®', 'üëç', 'üò¢', 'üôè', 'ü•∞', 'üòò'],
            '–õ—é–¥–∏': ['üëã', 'üôÇ', 'üòÉ', 'üòÑ', 'üòÖ', 'ü§ó', 'ü§î', 'üò¥', 'ü•≥', 'üòá', 'ü§†', 'ü•∫', 'üò≠', 'üò°', 'ü§Ø'],
            '–ü—Ä–∏—Ä–æ–¥–∞': ['üåû', '‚≠ê', 'üåü', 'üåà', '‚òÄÔ∏è', 'üåô', '‚ö°', '‚ùÑÔ∏è', 'üî•', 'üíß', 'üåä'],
            '–ï–¥–∞': ['üçï', 'üçî', 'üçü', 'üåÆ', 'üç£', 'üç¶', 'üç©', '‚òï', 'üçµ', 'ü•§', 'üç∫'],
            '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è': ['üöó', '‚úàÔ∏è', 'üöÄ', 'üèñÔ∏è', 'üó∫Ô∏è', 'üé¢', 'üè∞', 'üåç', 'üèîÔ∏è', '‚õ∫'],
            '–°–ø–æ—Ä—Ç': ['‚öΩ', 'üèÄ', 'üéæ', 'üèÜ', 'üéØ', 'ü•ä', 'üèÉ', 'üö¥', 'üéø', 'üèä'],
            '–ü—Ä–µ–¥–º–µ—Ç—ã': ['üì±', 'üíª', 'üéÆ', 'üìö', 'üéµ', 'üé¨', 'üíé', 'üéÅ', 'üí°', 'üîë'],
            '–°–∏–º–≤–æ–ª—ã': ['‚úÖ', '‚ùå', '‚û°Ô∏è', '‚¨ÖÔ∏è', '‚¨ÜÔ∏è', '‚¨áÔ∏è', '‚è∞', 'üìÖ', 'üí∞', 'üéØ']
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const loginPage = document.getElementById('loginPage');
        const registerPage = document.getElementById('registerPage');
        const mainContent = document.getElementById('mainContent');
        const navbar = document.getElementById('navbar');
        const emojiPanel = document.getElementById('emojiPanel');
        const adminBadge = document.getElementById('adminBadge');
        const adminNavItem = document.getElementById('adminNavItem');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuClose = document.getElementById('mobileMenuClose');
        const mobileAdminNavItem = document.getElementById('mobileAdminNavItem');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initAdminAccount();
            checkAuth();
            loadSavedAccounts();
            initImageUpload();
            initEmojiPanel();
            initSearch();
            initChatSystem();
            initMobileMenu();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π email –µ—Å–ª–∏ –µ—Å—Ç—å
            const lastAccount = savedAccounts[savedAccounts.length - 1];
            if (lastAccount) {
                document.getElementById('loginEmail').value = lastAccount.email;
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        function initMobileMenu() {
            mobileMenuBtn.addEventListener('click', openMobileMenu);
            mobileMenuClose.addEventListener('click', closeMobileMenu);
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            document.addEventListener('click', function(e) {
                if (!mobileMenu.contains(e.target) && e.target !== mobileMenuBtn) {
                    closeMobileMenu();
                }
            });
        }

        function openMobileMenu() {
            mobileMenu.classList.add('active');
        }

        function closeMobileMenu() {
            mobileMenu.classList.remove('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç–∞
        function initAdminAccount() {
            const adminUser = users.find(user => user.email === ADMIN_EMAIL);
            if (!adminUser) {
                const newAdmin = {
                    id: 'admin',
                    firstName: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                    lastName: '–°–∏—Å—Ç–µ–º—ã',
                    email: ADMIN_EMAIL,
                    password: 'admin123',
                    username: 'admin',
                    bio: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏',
                    role: 'admin',
                    createdAt: new Date().toISOString()
                };
                users.push(newAdmin);
                localStorage.setItem('social_users', JSON.stringify(users));
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–º–æ–¥–∑–∏ –ø–∞–Ω–µ–ª–∏
        function initEmojiPanel() {
            let emojiHTML = '';
            
            for (const [category, emojis] of Object.entries(russianEmojis)) {
                emojiHTML += `
                    <div class="emoji-category">
                        <div class="category-title">${category}</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                            ${emojis.map(emoji => `
                                <span class="emoji-item" onclick="addEmojiToText('${emoji}')">${emoji}</span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            emojiPanel.innerHTML = emojiHTML;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
        function initSearch() {
            const friendSearch = document.getElementById('friendSearch');
            const adminUserSearch = document.getElementById('adminUserSearch');
            const chatSearch = document.getElementById('chatSearch');
            
            if (friendSearch) {
                friendSearch.addEventListener('input', function() {
                    searchUsers(this.value, 'searchResults');
                });
            }
            
            if (adminUserSearch) {
                adminUserSearch.addEventListener('input', function() {
                    searchUsers(this.value, 'adminUsersList', true);
                });
            }

            if (chatSearch) {
                chatSearch.addEventListener('input', function() {
                    searchChats(this.value);
                });
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —á–∞—Ç–æ–≤
        function initChats() {
            if (!chats[currentUser.id]) {
                chats[currentUser.id] = {};
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —á–∞—Ç–æ–≤
        function initChatSystem() {
            initChats();
            loadChatsList();
            loadGroupsList();
        }

        // –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        function searchUsers(query, targetElement, isAdmin = false) {
            const container = document.getElementById(targetElement);
            if (!query.trim()) {
                if (targetElement === 'searchResults') {
                    container.innerHTML = '<div class="no-posts">–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥—Ä—É–∑–µ–π</div>';
                } else {
                    container.innerHTML = '<div class="no-posts">–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞</div>';
                }
                return;
            }

            const searchResults = users.filter(user => 
                user.id !== currentUser.id &&
                !user.role && // –ò—Å–∫–ª—é—á–∞–µ–º –∞–¥–º–∏–Ω–æ–≤ –∏–∑ –ø–æ–∏—Å–∫–∞
                (user.firstName.toLowerCase().includes(query.toLowerCase()) ||
                 user.lastName.toLowerCase().includes(query.toLowerCase()) ||
                 user.email.toLowerCase().includes(query.toLowerCase()))
            );

            if (searchResults.length === 0) {
                container.innerHTML = '<div class="no-posts">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            if (isAdmin) {
                // –ê–¥–º–∏–Ω—Å–∫–∏–π –≤–∏–¥
                container.innerHTML = searchResults.map(user => {
                    const isBlocked = blockedUsers.includes(user.id);
                    const isFriend = friends[currentUser.id]?.includes(user.id);
                    return `
                        <div class="user-item ${isBlocked ? 'blocked-account' : ''}">
                            <div class="user-avatar-small">${getInitials(user.firstName, user.lastName)}</div>
                            <div class="user-info">
                                <div class="user-name">
                                    ${user.firstName} ${user.lastName}
                                    ${isBlocked ? '<span class="blocked-badge">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</span>' : ''}
                                </div>
                                <div class="user-email">${user.email}</div>
                            </div>
                            <div class="user-actions">
                                ${!isBlocked ? `
                                    <button class="action-btn btn-danger" onclick="blockUser('${user.id}')">
                                        <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                ` : `
                                    <button class="action-btn btn-success" onclick="unblockUser('${user.id}')">
                                        <i class="fas fa-check"></i> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                `}
                                <button class="action-btn btn-warning" onclick="viewUserProfile('${user.id}')">
                                    <i class="fas fa-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                // –û–±—ã—á–Ω—ã–π –ø–æ–∏—Å–∫ –¥—Ä—É–∑–µ–π
                container.innerHTML = searchResults.map(user => {
                    const isFriend = friends[currentUser.id]?.includes(user.id);
                    const isBlocked = blockedUsers.includes(user.id);
                    const isBlockedForMe = blockedForMe[currentUser.id]?.includes(user.id);
                    
                    if (isBlocked || isBlockedForMe) return '';
                    
                    return `
                        <div class="user-item">
                            <div class="user-avatar-small">${getInitials(user.firstName, user.lastName)}</div>
                            <div class="user-info">
                                <div class="user-name">${user.firstName} ${user.lastName}</div>
                                <div class="user-email">${user.email}</div>
                            </div>
                            <div class="user-actions">
                                ${!isFriend ? `
                                    <button class="action-btn btn-primary" onclick="addFriend('${user.id}')">
                                        <i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å
                                    </button>
                                ` : `
                                    <button class="action-btn btn-danger" onclick="removeFriend('${user.id}')">
                                        <i class="fas fa-user-minus"></i> –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                `}
                                <button class="action-btn btn-warning" onclick="reportUser('${user.id}')">
                                    <i class="fas fa-flag"></i> –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è
                                </button>
                                <button class="action-btn btn-success" onclick="startChatWithUser('${user.id}')">
                                    <i class="fas fa-comment"></i> –ß–∞—Ç
                                </button>
                                <button class="action-btn btn-secondary" onclick="blockUserForMe('${user.id}')">
                                    <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        // –ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤
        function searchChats(query) {
            const chatsList = document.getElementById('chatsList');
            const userChats = chats[currentUser.id] || {};
            const chatIds = Object.keys(userChats);
            
            if (!query.trim()) {
                loadChatsList();
                return;
            }

            const filteredChats = chatIds.filter(chatId => {
                const partner = users.find(u => u.id === chatId);
                return partner && (
                    partner.firstName.toLowerCase().includes(query.toLowerCase()) ||
                    partner.lastName.toLowerCase().includes(query.toLowerCase()) ||
                    partner.email.toLowerCase().includes(query.toLowerCase())
                );
            });

            if (filteredChats.length === 0) {
                chatsList.innerHTML = '<div class="no-posts">–ß–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }

            chatsList.innerHTML = filteredChats.map(chatId => {
                const chat = userChats[chatId];
                const partner = users.find(u => u.id === chatId);
                if (!partner) return '';
                
                const lastMessage = chat.messages[chat.messages.length - 1];
                const unreadCount = chat.messages.filter(m => !m.read && m.senderId !== currentUser.id).length;
                
                return `
                    <div class="chat-item" onclick="openChat('${chatId}')">
                        <div class="user-avatar-small">${getInitials(partner.firstName, partner.lastName)}</div>
                        <div class="chat-info">
                            <div class="chat-partner-name">${partner.firstName} ${partner.lastName}</div>
                            <div class="last-message">${lastMessage ? lastMessage.text : '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π'}</div>
                        </div>
                        <div class="chat-meta">
                            <div class="last-time">${lastMessage ? formatTime(lastMessage.timestamp) : ''}</div>
                            ${unreadCount > 0 ? `<div class="unread-badge">${unreadCount}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–º–æ–¥–∑–∏ –ø–∞–Ω–µ–ª—å
        function showEmojiPanel() {
            const textarea = document.getElementById('postContent');
            const rect = textarea.getBoundingClientRect();
            
            emojiPanel.style.display = 'flex';
            emojiPanel.style.top = (rect.top - emojiPanel.offsetHeight - 10) + 'px';
            emojiPanel.style.left = rect.left + 'px';
        }

        // –î–æ–±–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç
        function addEmojiToText(emoji) {
            const textarea = document.getElementById('postContent');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            textarea.value = textarea.value.substring(0, start) + emoji + textarea.value.substring(end);
            textarea.focus();
            textarea.selectionStart = textarea.selectionEnd = start + emoji.length;
            emojiPanel.style.display = 'none';
        }

        // –ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä—É—Å—Å–∫–æ–≥–æ —ç–º–æ–¥–∑–∏
        function addRussianEmoji(emoji) {
            addEmojiToText(emoji);
        }

        // –°–∫—Ä—ã—Ç—å —ç–º–æ–¥–∑–∏ –ø–∞–Ω–µ–ª—å –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ—ë
        document.addEventListener('click', function(e) {
            if (!emojiPanel.contains(e.target) && e.target.id !== 'postContent' && !e.target.closest('.icon-btn')) {
                emojiPanel.style.display = 'none';
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
        function initImageUpload() {
            const imageUpload = document.getElementById('imageUpload');
            const imagePreview = document.getElementById('imagePreview');
            
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–º–∞–∫—Å–∏–º—É–º 5MB)
                    if (file.size > 5 * 1024 * 1024) {
                        showError('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π! –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä - 5MB');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        imagePreview.src = e.target.result;
                        imagePreview.style.display = 'block';
                    }
                    reader.readAsDataURL(file);
                }
            });
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function checkAuth() {
            if (currentUser) {
                showMainApp();
            } else {
                showLogin();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
        function showMainApp() {
            loginPage.classList.add('hidden');
            registerPage.classList.add('hidden');
            mainContent.classList.remove('hidden');
            navbar.classList.remove('hidden');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω—Å–∫–∏–µ –ø—Ä–∞–≤–∞
            if (currentUser.email === ADMIN_EMAIL || currentUser.role === 'admin') {
                adminBadge.classList.remove('hidden');
                adminNavItem.classList.remove('hidden');
                mobileAdminNavItem.classList.remove('hidden');
                currentUser.role = 'admin';
            } else {
                // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
                adminBadge.classList.add('hidden');
                adminNavItem.classList.add('hidden');
                mobileAdminNavItem.classList.add('hidden');
            }
            
            updateUserInfo();
            loadPosts();
            updateStats();
            loadUserGallery();
            loadSupportTickets();
            loadFriendsList();
            initChatSystem();
            if (currentUser.role === 'admin') {
                loadAdminPanel();
            }
            showPage('feed');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function updateUserInfo() {
            const userAvatar = document.getElementById('userAvatar');
            const currentUserAvatar = document.getElementById('currentUserAvatar');
            const profileUserAvatar = document.getElementById('profileUserAvatar');
            const profileUserName = document.getElementById('profileUserName');
            const profileUserEmail = document.getElementById('profileUserEmail');
            const profileBio = document.getElementById('profileBio');

            const initials = getInitials(currentUser.firstName, currentUser.lastName);
            
            userAvatar.textContent = initials;
            currentUserAvatar.textContent = initials;
            profileUserAvatar.textContent = initials;
            profileUserName.textContent = `${currentUser.firstName} ${currentUser.lastName}`;
            profileUserEmail.textContent = currentUser.email;
            profileBio.textContent = currentUser.bio || '–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ —Å–µ–±–µ... üìù';
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª—ã
        function getInitials(firstName, lastName) {
            return (firstName[0] + lastName[0]).toUpperCase();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        function showPage(pageName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });

            // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.mobile-nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById(pageName + 'Page').classList.add('active');

            // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É–Ω–∫—Ç –º–µ–Ω—é
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.textContent.includes(getPageTitle(pageName))) {
                    item.classList.add('active');
                }
            });
            
            document.querySelectorAll('.mobile-nav-item').forEach(item => {
                if (item.textContent.includes(getPageTitle(pageName))) {
                    item.classList.add('active');
                }
            });

            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            if (pageName === 'profile') {
                loadProfilePosts();
            } else if (pageName === 'archive') {
                loadArchiveAccounts();
            } else if (pageName === 'support') {
                loadSupportTickets();
            } else if (pageName === 'friends') {
                loadFriendsList();
            } else if (pageName === 'chats') {
                loadChatsList();
            } else if (pageName === 'groups') {
                loadGroupsList();
            } else if (pageName === 'admin' && currentUser.role === 'admin') {
                loadAdminPanel();
            }
            
            // –ó–∞–∫—Ä—ã—Ç—å –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
            closeMobileMenu();
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function getPageTitle(pageName) {
            const titles = {
                'feed': '–õ–µ–Ω—Ç–∞',
                'profile': '–ü—Ä–æ—Ñ–∏–ª—å',
                'friends': '–î—Ä—É–∑—å—è',
                'chats': '–ß–∞—Ç—ã',
                'groups': '–ì—Ä—É–ø–ø—ã',
                'gallery': '–ì–∞–ª–µ—Ä–µ—è',
                'archive': '–ê—Ä—Ö–∏–≤',
                'support': '–ü–æ–¥–¥–µ—Ä–∂–∫–∞',
                'admin': '–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å'
            };
            return titles[pageName] || pageName;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
        function loadSavedAccounts() {
            const savedAccountsContainer = document.getElementById('savedAccounts');
            
            if (savedAccounts.length === 0) {
                savedAccountsContainer.innerHTML = '';
                return;
            }

            savedAccountsContainer.innerHTML = `
                <div style="margin-bottom: 15px; font-weight: 600; color: var(--dark);">
                    <i class="fas fa-history"></i> –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥:
                </div>
            `;
            
            savedAccounts.forEach(account => {
                const accountElement = document.createElement('div');
                accountElement.className = 'account-item';
                accountElement.innerHTML = `
                    <div class="account-avatar">${getInitials(account.firstName, account.lastName)}</div>
                    <div class="account-info">
                        <div class="account-name">${account.firstName} ${account.lastName}</div>
                        <div class="account-email">${account.email}</div>
                    </div>
                `;
                accountElement.onclick = () => quickLogin(account.email);
                savedAccountsContainer.appendChild(accountElement);
            });
        }

        // –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥
        function quickLogin(email) {
            document.getElementById('loginEmail').value = email;
            document.getElementById('loginPassword').focus();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ö–∏–≤–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
        function loadArchiveAccounts() {
            const archiveList = document.getElementById('archiveAccountsList');
            
            if (savedAccounts.length === 0) {
                archiveList.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-users" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤</p>
                    </div>
                `;
                return;
            }

            archiveList.innerHTML = savedAccounts.map(account => `
                <div class="account-item" onclick="switchAccount('${account.email}')">
                    <div class="account-avatar">${getInitials(account.firstName, account.lastName)}</div>
                    <div class="account-info">
                        <div class="account-name">${account.firstName} ${account.lastName}</div>
                        <div class="account-email">${account.email}</div>
                    </div>
                    <button class="btn btn-secondary" onclick="event.stopPropagation(); removeAccount('${account.email}')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
        function switchAccount(email) {
            const account = savedAccounts.find(acc => acc.email === email);
            if (account) {
                currentUser = account;
                localStorage.setItem('current_user', JSON.stringify(account));
                showMainApp();
                showSuccess(`–í—ã –≤–æ—à–ª–∏ –∫–∞–∫ ${account.firstName} ${account.lastName} üëã`);
            }
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–∑ –∞—Ä—Ö–∏–≤–∞
        function removeAccount(email) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∞–∫–∫–∞—É–Ω—Ç –∏–∑ –∞—Ä—Ö–∏–≤–∞? üóëÔ∏è')) {
                savedAccounts = savedAccounts.filter(acc => acc.email !== email);
                localStorage.setItem('saved_accounts', JSON.stringify(savedAccounts));
                loadArchiveAccounts();
                loadSavedAccounts();
                showSuccess('–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∞—Ä—Ö–∏–≤–∞ ‚úÖ');
            }
        }

        // –°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π
        function loadFriendsList() {
            const friendsList = document.getElementById('friendsList');
            const userFriends = friends[currentUser.id] || [];
            
            if (userFriends.length === 0) {
                friendsList.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-users" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫!</p>
                    </div>
                `;
                return;
            }

            friendsList.innerHTML = userFriends.map(friendId => {
                const friend = users.find(u => u.id === friendId);
                if (!friend || blockedUsers.includes(friendId) || blockedForMe[currentUser.id]?.includes(friendId)) return '';
                
                return `
                    <div class="user-item">
                        <div class="user-avatar-small">${getInitials(friend.firstName, friend.lastName)}</div>
                        <div class="user-info">
                            <div class="user-name">${friend.firstName} ${friend.lastName}</div>
                            <div class="user-email">${friend.email}</div>
                        </div>
                        <div class="user-actions">
                            <button class="action-btn btn-danger" onclick="removeFriend('${friend.id}')">
                                <i class="fas fa-user-minus"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                            <button class="action-btn btn-warning" onclick="reportUser('${friend.id}')">
                                <i class="fas fa-flag"></i> –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è
                            </button>
                            <button class="action-btn btn-success" onclick="startChatWithUser('${friend.id}')">
                                <i class="fas fa-comment"></i> –ß–∞—Ç
                            </button>
                            <button class="action-btn btn-secondary" onclick="blockUserForMe('${friend.id}')">
                                <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function addFriend(userId) {
            if (!friends[currentUser.id]) {
                friends[currentUser.id] = [];
            }
            
            if (!friends[currentUser.id].includes(userId)) {
                friends[currentUser.id].push(userId);
                localStorage.setItem('user_friends', JSON.stringify(friends));
                loadFriendsList();
                showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥—Ä—É–∑—å—è! üë•');
            }
        }

        function removeFriend(userId) {
            if (friends[currentUser.id]) {
                friends[currentUser.id] = friends[currentUser.id].filter(id => id !== userId);
                localStorage.setItem('user_friends', JSON.stringify(friends));
                loadFriendsList();
                showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω –∏–∑ –¥—Ä—É–∑–µ–π ‚ùå');
            }
        }

        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ–±—è
        function blockUserForMe(userId) {
            if (confirm('–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–µ–±—è? –í—ã –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å –µ–≥–æ –ø–æ—Å—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è.')) {
                if (!blockedForMe[currentUser.id]) {
                    blockedForMe[currentUser.id] = [];
                }
                
                if (!blockedForMe[currentUser.id].includes(userId)) {
                    blockedForMe[currentUser.id].push(userId);
                    localStorage.setItem('blocked_for_me', JSON.stringify(blockedForMe));
                    
                    // –£–¥–∞–ª—è–µ–º –∏–∑ –¥—Ä—É–∑–µ–π –µ—Å–ª–∏ –µ—Å—Ç—å
                    removeFriend(userId);
                    
                    // –£–¥–∞–ª—è–µ–º —á–∞—Ç –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (chats[currentUser.id] && chats[currentUser.id][userId]) {
                        delete chats[currentUser.id][userId];
                        localStorage.setItem('user_chats', JSON.stringify(chats));
                    }
                    
                    loadFriendsList();
                    loadChatsList();
                    loadPosts();
                    showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–∞—Å üîí');
                }
            }
        }

        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–µ–±—è
        function unblockUserForMe(userId) {
            if (blockedForMe[currentUser.id]) {
                blockedForMe[currentUser.id] = blockedForMe[currentUser.id].filter(id => id !== userId);
                localStorage.setItem('blocked_for_me', JSON.stringify(blockedForMe));
                loadFriendsList();
                showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–∞—Å üîì');
            }
        }

        // –°–∏—Å—Ç–µ–º–∞ —á–∞—Ç–æ–≤
        function loadChatsList() {
            const chatsList = document.getElementById('chatsList');
            const userChats = chats[currentUser.id] || {};
            const chatIds = Object.keys(userChats);
            
            if (chatIds.length === 0) {
                chatsList.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-comments" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —á–∞—Ç–æ–≤</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –¥—Ä—É–∑—å—è–º–∏!</p>
                    </div>
                `;
                return;
            }

            chatsList.innerHTML = chatIds.map(chatId => {
                const chat = userChats[chatId];
                const partner = users.find(u => u.id === chatId);
                if (!partner || blockedForMe[currentUser.id]?.includes(chatId)) return '';
                
                const lastMessage = chat.messages[chat.messages.length - 1];
                const unreadCount = chat.messages.filter(m => !m.read && m.senderId !== currentUser.id).length;
                
                return `
                    <div class="chat-item" onclick="openChat('${chatId}')">
                        <div class="user-avatar-small">${getInitials(partner.firstName, partner.lastName)}</div>
                        <div class="chat-info">
                            <div class="chat-partner-name">${partner.firstName} ${partner.lastName}</div>
                            <div class="last-message">${lastMessage ? lastMessage.text : '–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π'}</div>
                        </div>
                        <div class="chat-meta">
                            <div class="last-time">${lastMessage ? formatTime(lastMessage.timestamp) : ''}</div>
                            ${unreadCount > 0 ? `<div class="unread-badge">${unreadCount}</div>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function startNewChat() {
            const friendId = prompt('–í–≤–µ–¥–∏—Ç–µ ID –¥—Ä—É–≥–∞ –∏–ª–∏ –µ–≥–æ email:');
            if (friendId) {
                const friend = users.find(u => u.id === friendId || u.email === friendId);
                if (friend && friend.id !== currentUser.id) {
                    startChatWithUser(friend.id);
                } else {
                    showError('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
            }
        }

        function startChatWithUser(userId) {
            openChat(userId);
        }

        function openChat(partnerId) {
            const partner = users.find(u => u.id === partnerId);
            if (!partner || blockedForMe[currentUser.id]?.includes(partnerId)) {
                showError('–ù–µ–ª—å–∑—è –æ—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º');
                return;
            }
            
            currentChat = partnerId;
            
            // –°–æ–∑–¥–∞–µ–º —á–∞—Ç –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            if (!chats[currentUser.id][partnerId]) {
                chats[currentUser.id][partnerId] = {
                    partnerId: partnerId,
                    messages: [],
                    createdAt: new Date().toISOString()
                };
                localStorage.setItem('user_chats', JSON.stringify(chats));
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('chatPartnerAvatar').textContent = getInitials(partner.firstName, partner.lastName);
            document.getElementById('chatPartnerName').textContent = `${partner.firstName} ${partner.lastName}`;
            document.getElementById('chatPartnerStatus').textContent = '–≤ —Å–µ—Ç–∏';
            
            showPage('chat');
            loadChatMessages();
        }

        function loadChatMessages() {
            const messagesContainer = document.getElementById('chatMessages');
            const chat = chats[currentUser.id][currentChat];
            
            messagesContainer.innerHTML = chat.messages.map(message => {
                const sender = users.find(u => u.id === message.senderId);
                const isOwn = message.senderId === currentUser.id;
                
                return `
                    <div class="message ${isOwn ? 'own-message' : 'partner-message'}">
                        <div class="message-content">
                            <div class="message-text">${message.text}</div>
                            <div class="message-time">${formatTime(message.timestamp)}</div>
                            ${isOwn ? `
                                <div class="message-actions">
                                    <button class="message-action-btn" onclick="deleteMessage('${currentChat}', '${message.id}')" title="–£–¥–∞–ª–∏—Ç—å">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatMessageInput');
            const text = input.value.trim();
            
            if (!text || !currentChat) return;
            
            const message = {
                id: generateId(),
                senderId: currentUser.id,
                text: text,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–≤–æ–π —á–∞—Ç
            chats[currentUser.id][currentChat].messages.push(message);
            
            // –°–æ–∑–¥–∞–µ–º/–æ–±–Ω–æ–≤–ª—è–µ–º —á–∞—Ç —É –ø–æ–ª—É—á–∞—Ç–µ–ª—è
            if (!chats[currentChat]) chats[currentChat] = {};
            if (!chats[currentChat][currentUser.id]) {
                chats[currentChat][currentUser.id] = {
                    partnerId: currentUser.id,
                    messages: [],
                    createdAt: new Date().toISOString()
                };
            }
            chats[currentChat][currentUser.id].messages.push(message);
            
            localStorage.setItem('user_chats', JSON.stringify(chats));
            
            // –û—á–∏—â–∞–µ–º input –∏ –æ–±–Ω–æ–≤–ª—è–µ–º UI
            input.value = '';
            loadChatMessages();
            loadChatsList(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
        function deleteMessage(chatId, messageId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
                const chat = chats[currentUser.id][chatId];
                if (chat) {
                    chat.messages = chat.messages.filter(msg => msg.id !== messageId);
                    localStorage.setItem('user_chats', JSON.stringify(chats));
                    loadChatMessages();
                    showSuccess('–°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ üóëÔ∏è');
                }
            }
        }

        // –°–∏—Å—Ç–µ–º–∞ –≥—Ä—É–ø–ø
        function loadGroupsList() {
            const groupsList = document.getElementById('groupsList');
            const userGroups = Object.values(groups).filter(group => 
                group.members.includes(currentUser.id)
            );
            
            if (userGroups.length === 0) {
                groupsList.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-users" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥—Ä—É–ø–ø–∞—Ö</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é –≥—Ä—É–ø–ø—É!</p>
                    </div>
                `;
                return;
            }
            
            groupsList.innerHTML = userGroups.map(group => `
                <div class="group-card" onclick="openGroupChat('${group.id}')">
                    <div class="group-avatar-large">${group.name[0]}</div>
                    <div class="group-info">
                        <h4>${group.name}</h4>
                        <p>${group.description || '–ë–µ–∑ –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                        <div class="group-meta">
                            <span>${group.members.length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</span>
                            <span>${group.messages ? group.messages.length : 0} —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showCreateGroupForm() {
            document.getElementById('createGroupForm').classList.remove('hidden');
            loadFriendsForGroup();
        }

        function hideCreateGroupForm() {
            document.getElementById('createGroupForm').classList.add('hidden');
        }

        function loadFriendsForGroup() {
            const container = document.getElementById('groupMembersSelect');
            const userFriends = friends[currentUser.id] || [];
            
            container.innerHTML = userFriends.map(friendId => {
                const friend = users.find(u => u.id === friendId);
                if (!friend) return '';
                
                return `
                    <div class="user-select-item">
                        <input type="checkbox" id="friend-${friend.id}" value="${friend.id}">
                        <label for="friend-${friend.id}">
                            <div class="user-avatar-small">${getInitials(friend.firstName, friend.lastName)}</div>
                            <div class="user-name">${friend.firstName} ${friend.lastName}</div>
                        </label>
                    </div>
                `;
            }).join('');
        }

        function createGroup(event) {
            event.preventDefault();
            
            const name = document.getElementById('groupName').value;
            const description = document.getElementById('groupDescription').value;
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            const selectedFriends = [];
            document.querySelectorAll('#groupMembersSelect input:checked').forEach(checkbox => {
                selectedFriends.push(checkbox.value);
            });
            
            const group = {
                id: generateId(),
                name: name,
                description: description,
                creatorId: currentUser.id,
                members: [currentUser.id, ...selectedFriends],
                messages: [],
                createdAt: new Date().toISOString()
            };
            
            groups[group.id] = group;
            localStorage.setItem('user_groups', JSON.stringify(groups));
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('groupName').value = '';
            document.getElementById('groupDescription').value = '';
            document.querySelectorAll('#groupMembersSelect input:checked').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            hideCreateGroupForm();
            loadGroupsList();
            showSuccess(`–ì—Ä—É–ø–ø–∞ "${name}" —Å–æ–∑–¥–∞–Ω–∞! üë•`);
        }

        function openGroupChat(groupId) {
            currentGroup = groupId;
            const group = groups[groupId];
            
            document.getElementById('groupChatAvatar').textContent = group.name[0];
            document.getElementById('groupChatName').textContent = group.name;
            document.getElementById('groupChatMembers').textContent = `${group.members.length} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤`;
            
            showPage('groupChat');
            loadGroupMessages();
        }

        function loadGroupMessages() {
            const messagesContainer = document.getElementById('groupChatMessages');
            const group = groups[currentGroup];
            
            messagesContainer.innerHTML = group.messages.map(message => {
                const sender = users.find(u => u.id === message.senderId);
                const isOwn = message.senderId === currentUser.id;
                
                return `
                    <div class="message ${isOwn ? 'own-message' : 'group-message'}">
                        ${!isOwn ? `<div class="message-sender">${sender.firstName} ${sender.lastName}</div>` : ''}
                        <div class="message-content">
                            <div class="message-text">${message.text}</div>
                            <div class="message-time">${formatTime(message.timestamp)}</div>
                            ${isOwn ? `
                                <div class="message-actions">
                                    <button class="message-action-btn" onclick="deleteGroupMessage('${currentGroup}', '${message.id}')" title="–£–¥–∞–ª–∏—Ç—å">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function sendGroupMessage() {
            const input = document.getElementById('groupMessageInput');
            const text = input.value.trim();
            
            if (!text || !currentGroup) return;
            
            const message = {
                id: generateId(),
                senderId: currentUser.id,
                text: text,
                timestamp: new Date().toISOString()
            };
            
            groups[currentGroup].messages.push(message);
            localStorage.setItem('user_groups', JSON.stringify(groups));
            
            input.value = '';
            loadGroupMessages();
        }

        // –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ
        function deleteGroupMessage(groupId, messageId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ?')) {
                const group = groups[groupId];
                if (group) {
                    group.messages = group.messages.filter(msg => msg.id !== messageId);
                    localStorage.setItem('user_groups', JSON.stringify(groups));
                    loadGroupMessages();
                    showSuccess('–°–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ üóëÔ∏è');
                }
            }
        }

        function showGroupInfo() {
            const group = groups[currentGroup];
            if (!group) return;
            
            const memberNames = group.members.map(memberId => {
                const user = users.find(u => u.id === memberId);
                return user ? `${user.firstName} ${user.lastName}` : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π';
            }).join(', ');
            
            alert(`–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–µ:\n\n–ù–∞–∑–≤–∞–Ω–∏–µ: ${group.name}\n–û–ø–∏—Å–∞–Ω–∏–µ: ${group.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}\n–£—á–∞—Å—Ç–Ω–∏–∫–∏: ${memberNames}`);
        }

        // –°–∏—Å—Ç–µ–º–∞ –∂–∞–ª–æ–±
        function reportUser(userId) {
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∂–∞–ª–æ–±—ã:');
            if (reason) {
                const complaint = {
                    id: generateId(),
                    reporterId: currentUser.id,
                    reportedUserId: userId,
                    reason: reason,
                    status: 'new',
                    createdAt: new Date().toISOString()
                };
                
                complaints.push(complaint);
                localStorage.setItem('user_complaints', JSON.stringify(complaints));
                showSuccess('–ñ–∞–ª–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É! üõ°Ô∏è');
            }
        }

        function reportPost(postId) {
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –∂–∞–ª–æ–±—ã –Ω–∞ –ø–æ—Å—Ç:');
            if (reason) {
                const complaint = {
                    id: generateId(),
                    reporterId: currentUser.id,
                    postId: postId,
                    reason: reason,
                    type: 'post',
                    status: 'new',
                    createdAt: new Date().toISOString()
                };
                
                complaints.push(complaint);
                localStorage.setItem('user_complaints', JSON.stringify(complaints));
                showSuccess('–ñ–∞–ª–æ–±–∞ –Ω–∞ –ø–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É! üõ°Ô∏è');
            }
        }

        // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
        function loadAdminPanel() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
            if (currentUser.role !== 'admin') {
                showError('–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω! –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.');
                showPage('feed');
                return;
            }
            
            updateAdminStats();
            loadAdminUsers();
            loadAdminComplaints();
        }

        function updateAdminStats() {
            document.getElementById('adminTotalUsers').textContent = users.filter(u => !u.role).length;
            document.getElementById('adminBlockedUsers').textContent = blockedUsers.length;
            document.getElementById('adminTotalPosts').textContent = posts.length;
            document.getElementById('adminTotalComplaints').textContent = complaints.length;
        }

        function loadAdminUsers() {
            const normalUsers = users.filter(user => !user.role);
            const container = document.getElementById('adminUsersList');
            
            if (normalUsers.length === 0) {
                container.innerHTML = '<div class="no-posts">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>';
                return;
            }

            container.innerHTML = normalUsers.map(user => {
                const isBlocked = blockedUsers.includes(user.id);
                const userPosts = posts.filter(p => p.author.id === user.id).length;
                const userComplaints = complaints.filter(c => c.reportedUserId === user.id).length;
                
                return `
                    <div class="user-item ${isBlocked ? 'blocked-account' : ''}">
                        <div class="user-avatar-small">${getInitials(user.firstName, user.lastName)}</div>
                        <div class="user-info">
                            <div class="user-name">
                                ${user.firstName} ${user.lastName}
                                ${isBlocked ? '<span class="blocked-badge">–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù</span>' : ''}
                            </div>
                            <div class="user-email">${user.email}</div>
                            <div style="font-size: 0.7em; color: #718096;">
                                –ü–æ—Å—Ç–æ–≤: ${userPosts} | –ñ–∞–ª–æ–±: ${userComplaints}
                            </div>
                        </div>
                        <div class="user-actions">
                            ${!isBlocked ? `
                                <button class="action-btn btn-danger" onclick="blockUser('${user.id}')">
                                    <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            ` : `
                                <button class="action-btn btn-success" onclick="unblockUser('${user.id}')">
                                    <i class="fas fa-check"></i> –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            `}
                            <button class="action-btn btn-warning" onclick="viewUserPosts('${user.id}')">
                                <i class="fas fa-eye"></i> –ü–æ—Å—Ç—ã
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadAdminComplaints() {
            const container = document.getElementById('adminComplaintsList');
            const newComplaints = complaints.filter(c => c.status === 'new');
            
            if (newComplaints.length === 0) {
                container.innerHTML = '<div class="no-posts">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∂–∞–ª–æ–±</div>';
                return;
            }

            container.innerHTML = newComplaints.map(complaint => {
                const reporter = users.find(u => u.id === complaint.reporterId);
                const reportedUser = users.find(u => u.id === complaint.reportedUserId);
                const post = complaint.postId ? posts.find(p => p.id === complaint.postId) : null;
                
                return `
                    <div class="complaint-item">
                        <div class="complaint-header">
                            <h4>–ñ–∞–ª–æ–±–∞ –æ—Ç ${reporter ? `${reporter.firstName} ${reporter.lastName}` : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π'}</h4>
                            <span class="ticket-status status-open">–ù–û–í–ê–Ø</span>
                        </div>
                        <div class="complaint-meta">
                            <span>–ù–∞: ${reportedUser ? `${reportedUser.firstName} ${reportedUser.lastName}` : '–ü–æ—Å—Ç'}</span>
                            <span>${formatDate(complaint.createdAt)}</span>
                        </div>
                        <p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> ${complaint.reason}</p>
                        ${post ? `<p><strong>–ü–æ—Å—Ç:</strong> ${post.content.substring(0, 100)}...</p>` : ''}
                        <div class="complaint-actions">
                            <button class="btn btn-danger" onclick="resolveComplaint('${complaint.id}', 'block')">
                                <i class="fas fa-ban"></i> –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                            </button>
                            <button class="btn btn-warning" onclick="resolveComplaint('${complaint.id}', 'ignore')">
                                <i class="fas fa-times"></i> –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∂–∞–ª–æ–±—É
                            </button>
                            ${post ? `
                                <button class="btn btn-secondary" onclick="deletePost('${post.id}', '${complaint.id}')">
                                    <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function blockUser(userId) {
            if (confirm('–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                if (!blockedUsers.includes(userId)) {
                    blockedUsers.push(userId);
                    localStorage.setItem('blocked_users', JSON.stringify(blockedUsers));
                    loadAdminUsers();
                    updateAdminStats();
                    showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω! üîí');
                }
            }
        }

        function unblockUser(userId) {
            if (confirm('–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) {
                blockedUsers = blockedUsers.filter(id => id !== userId);
                localStorage.setItem('blocked_users', JSON.stringify(blockedUsers));
                loadAdminUsers();
                updateAdminStats();
                showSuccess('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω! üîì');
            }
        }

        function resolveComplaint(complaintId, action) {
            const complaint = complaints.find(c => c.id === complaintId);
            if (complaint) {
                complaint.status = 'resolved';
                complaint.resolvedAt = new Date().toISOString();
                complaint.action = action;
                
                if (action === 'block' && complaint.reportedUserId) {
                    if (!blockedUsers.includes(complaint.reportedUserId)) {
                        blockedUsers.push(complaint.reportedUserId);
                    }
                }
                
                localStorage.setItem('user_complaints', JSON.stringify(complaints));
                localStorage.setItem('blocked_users', JSON.stringify(blockedUsers));
                loadAdminComplaints();
                updateAdminStats();
                showSuccess('–ñ–∞–ª–æ–±–∞ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞! ‚úÖ');
            }
        }

        function deletePost(postId, complaintId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) {
                posts = posts.filter(p => p.id !== postId);
                localStorage.setItem('social_posts', JSON.stringify(posts));
                
                const complaint = complaints.find(c => c.id === complaintId);
                if (complaint) {
                    complaint.status = 'resolved';
                    complaint.resolvedAt = new Date().toISOString();
                    complaint.action = 'post_deleted';
                    localStorage.setItem('user_complaints', JSON.stringify(complaints));
                }
                
                loadAdminComplaints();
                loadPosts();
                showSuccess('–ü–æ—Å—Ç —É–¥–∞–ª–µ–Ω! üóëÔ∏è');
            }
        }

        function viewUserPosts(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            const userPosts = posts.filter(post => post.author.id === userId);
            let postsText = userPosts.map(post => `üìù ${post.content.substring(0, 50)}...`).join('\n');
            if (!postsText) postsText = '–ù–µ—Ç –ø–æ—Å—Ç–æ–≤';
            
            alert(`–ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${user.firstName} ${user.lastName}:\n\n${postsText}`);
        }

        function viewUserProfile(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            const userPosts = posts.filter(post => post.author.id === userId).length;
            const userFriends = friends[userId] ? friends[userId].length : 0;
            
            alert(`–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n\n–ò–º—è: ${user.firstName} ${user.lastName}\nEmail: ${user.email}\n–ü–æ—Å—Ç–æ–≤: ${userPosts}\n–î—Ä—É–∑–µ–π: ${userFriends}\n–ë–∏–æ: ${user.bio || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}`);
        }

        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
        function register(event) {
            event.preventDefault();
            
            const firstName = document.getElementById('regFirstName').value;
            const lastName = document.getElementById('regLastName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
            if (users.find(user => user.email === email)) {
                showError('–ê–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚ùå');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è
            if (password.length < 6) {
                showError('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤ üîí');
                return;
            }

            const newUser = {
                id: generateId(),
                firstName,
                lastName,
                email,
                password,
                username: email.split('@')[0],
                bio: '',
                createdAt: new Date().toISOString()
            };

            users.push(newUser);
            localStorage.setItem('social_users', JSON.stringify(users));

            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
            if (!savedAccounts.find(acc => acc.email === email)) {
                savedAccounts.push(newUser);
                localStorage.setItem('saved_accounts', JSON.stringify(savedAccounts));
            }

            showSuccess('–ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
            showLogin();
        }

        // –í—Ö–æ–¥ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
        function login(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
            const user = users.find(u => u.email === email);
            
            if (!user) {
                showError('–ê–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω ‚ùå');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            if (blockedUsers.includes(user.id)) {
                showError('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º üîí');
                return;
            }

            if (user.password !== password) {
                showError('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å üîí');
                return;
            }

            currentUser = user;
            localStorage.setItem('current_user', JSON.stringify(user));

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–∫–∫–∞—É–Ω—Ç –µ—Å–ª–∏ –æ—Ç–º–µ—á–µ–Ω–æ "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
            if (rememberMe && !savedAccounts.find(acc => acc.email === email)) {
                savedAccounts.push(user);
                localStorage.setItem('saved_accounts', JSON.stringify(savedAccounts));
            }

            showMainApp();
            showSuccess(`–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, ${user.firstName}! üëã`);
        }

        // –í—ã—Ö–æ–¥
        function logout() {
            currentUser = null;
            localStorage.removeItem('current_user');
            showLogin();
            showSuccess('–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ üëã');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ñ–æ—Ç–æ
        function createPost() {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            if (blockedUsers.includes(currentUser.id)) {
                showError('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ø–æ—Å—Ç—ã üîí');
                return;
            }

            const content = document.getElementById('postContent').value.trim();
            const imagePreview = document.getElementById('imagePreview');
            const imageUpload = document.getElementById('imageUpload');
            
            if (!content && !imagePreview.src) {
                showError('–î–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ —Ñ–æ—Ç–æ üìù');
                return;
            }

            let imageData = '';
            if (imagePreview.style.display !== 'none') {
                imageData = imagePreview.src;
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ –≤ –≥–∞–ª–µ—Ä–µ—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                if (!userImages[currentUser.id]) {
                    userImages[currentUser.id] = [];
                }
                userImages[currentUser.id].push(imageData);
                localStorage.setItem('user_images', JSON.stringify(userImages));
            }

            const newPost = {
                id: generateId(),
                author: currentUser,
                content,
                image: imageData,
                likes: [],
                comments: [],
                createdAt: new Date().toISOString()
            };

            posts.unshift(newPost);
            localStorage.setItem('social_posts', JSON.stringify(posts));
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('postContent').value = '';
            imagePreview.style.display = 'none';
            imagePreview.src = '';
            imageUpload.value = '';
            
            loadPosts();
            updateStats();
            loadUserGallery();
            showSuccess('–ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω! üéâ');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å—Ç–æ–≤
        function loadPosts() {
            const postsContainer = document.getElementById('postsContainer');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–æ—Å—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const visiblePosts = posts.filter(post => 
                !blockedUsers.includes(post.author.id) && 
                !blockedForMe[currentUser.id]?.includes(post.author.id)
            );
            
            if (visiblePosts.length === 0) {
                postsContainer.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-newspaper" style="font-size: 3em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <h3>–õ–µ–Ω—Ç–∞ –ø—É—Å—Ç–∞</h3>
                        <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç! ‚ú®</p>
                    </div>
                `;
                return;
            }

            postsContainer.innerHTML = visiblePosts.map(post => `
                <div class="post-card fade-in">
                    <div class="post-user">
                        <div class="user-avatar">${getInitials(post.author.firstName, post.author.lastName)}</div>
                        <div class="user-info">
                            <h4>${post.author.firstName} ${post.author.lastName}</h4>
                            <div class="username">@${post.author.username}</div>
                            <div class="post-time">${formatDate(post.createdAt)}</div>
                        </div>
                        ${currentUser.role !== 'admin' ? `
                            <button class="icon-btn report-btn" onclick="reportPost('${post.id}')" title="–ü–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è">
                                <i class="fas fa-flag"></i>
                            </button>
                        ` : ''}
                    </div>
                    
                    <div class="post-content">
                        <p>${post.content}</p>
                    </div>
                    
                    ${post.image ? `<img src="${post.image}" class="post-image" alt="–ü–æ—Å—Ç">` : ''}
                    
                    <div class="post-stats">
                        <span>${post.likes.length} ‚ù§Ô∏è</span>
                        <span>${post.comments.length} üí¨</span>
                    </div>
                    
                    <div class="post-actions-buttons">
                        <button class="action-button like-button ${post.likes.includes(currentUser.id) ? 'liked' : ''}" 
                                onclick="toggleLike('${post.id}')">
                            <i class="fas fa-heart"></i>
                            ${post.likes.includes(currentUser.id) ? '‚ù§Ô∏è' : 'ü§ç'} –ù—Ä–∞–≤–∏—Ç—Å—è
                        </button>
                        <button class="action-button comment-button" onclick="toggleComments('${post.id}')">
                            <i class="fas fa-comment"></i>
                            –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                    </div>
                    
                    <div class="comments-section" id="comments-${post.id}" style="display: none;">
                        <form class="comment-form" onsubmit="addComment('${post.id}', event)">
                            <input type="text" id="comment-${post.id}" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π... üí¨" required>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </form>
                        
                        <div class="comments-list">
                            ${post.comments.map(comment => `
                                <div class="comment">
                                    <div class="comment-avatar">${getInitials(comment.author.firstName, comment.author.lastName)}</div>
                                    <div class="comment-content">
                                        <div class="comment-header">
                                            <strong>${comment.author.firstName} ${comment.author.lastName}</strong>
                                            <span>${formatDate(comment.createdAt)}</span>
                                        </div>
                                        <p>${comment.content}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≥–∞–ª–µ—Ä–µ–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserGallery() {
            const galleryContainer = document.getElementById('userGallery');
            const userPhotos = userImages[currentUser.id] || [];

            if (userPhotos.length === 0) {
                galleryContainer.innerHTML = `
                    <div class="no-posts" style="grid-column: 1 / -1;">
                        <i class="fas fa-images" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–í –≤–∞—à–µ–π –≥–∞–ª–µ—Ä–µ–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ñ–æ—Ç–æ üì∏</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–î–æ–±–∞–≤–ª—è–π—Ç–µ —Ñ–æ—Ç–æ –≤ —Å–≤–æ–∏ –ø–æ—Å—Ç—ã!</p>
                    </div>
                `;
                return;
            }

            galleryContainer.innerHTML = userPhotos.map((photo, index) => `
                <div class="gallery-item" onclick="viewImage('${photo}')">
                    <img src="${photo}" alt="–§–æ—Ç–æ ${index + 1}">
                </div>
            `).join('');
        }

        // –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function viewImage(src) {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                cursor: pointer;
            `;
            
            const img = document.createElement('img');
            img.src = src;
            img.style.cssText = `
                max-width: 90%;
                max-height: 90%;
                border-radius: 10px;
            `;
            
            overlay.appendChild(img);
            overlay.onclick = () => overlay.remove();
            
            document.body.appendChild(overlay);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å—Ç–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è
        function loadProfilePosts() {
            const profilePostsContainer = document.getElementById('profilePostsContainer');
            const userPosts = posts.filter(post => post.author.id === currentUser.id);

            if (userPosts.length === 0) {
                profilePostsContainer.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-edit" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤ ‚úçÔ∏è</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–ù–∞—á–Ω–∏—Ç–µ –¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏!</p>
                    </div>
                `;
                return;
            }

            profilePostsContainer.innerHTML = userPosts.map(post => `
                <div class="post-card">
                    <div class="post-content">
                        <p>${post.content}</p>
                    </div>
                    ${post.image ? `<img src="${post.image}" class="post-image" alt="–ü–æ—Å—Ç">` : ''}
                    <div class="post-stats">
                        <span>${post.likes.length} ‚ù§Ô∏è</span>
                        <span>${post.comments.length} üí¨</span>
                        <span>${formatDate(post.createdAt)}</span>
                    </div>
                </div>
            `).join('');
        }

        // –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
        function showCreateTicketForm() {
            document.getElementById('createTicketForm').classList.remove('hidden');
        }

        function hideCreateTicketForm() {
            document.getElementById('createTicketForm').classList.add('hidden');
        }

        function createSupportTicket(event) {
            event.preventDefault();
            
            const subject = document.getElementById('ticketSubject').value;
            const type = document.getElementById('ticketType').value;
            const description = document.getElementById('ticketDescription').value;

            const newTicket = {
                id: generateId(),
                userId: currentUser.id,
                subject,
                type,
                description,
                status: 'open',
                createdAt: new Date().toISOString(),
                responses: []
            };

            supportTickets.unshift(newTicket);
            localStorage.setItem('support_tickets', JSON.stringify(supportTickets));

            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('ticketSubject').value = '';
            document.getElementById('ticketType').value = '';
            document.getElementById('ticketDescription').value = '';
            
            hideCreateTicketForm();
            loadSupportTickets();
            showSuccess('–û–±—Ä–∞—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É! üõ†Ô∏è –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
        }

        function loadSupportTickets() {
            const ticketsContainer = document.getElementById('ticketsContainer');
            const userTickets = supportTickets.filter(ticket => ticket.userId === currentUser.id);

            if (userTickets.length === 0) {
                ticketsContainer.innerHTML = `
                    <div class="no-posts">
                        <i class="fas fa-ticket-alt" style="font-size: 2em; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</p>
                        <p style="font-size: 0.9em; margin-top: 10px;">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ!</p>
                    </div>
                `;
                return;
            }

            ticketsContainer.innerHTML = userTickets.map(ticket => `
                <div class="support-ticket">
                    <div class="ticket-header">
                        <h4>${ticket.subject}</h4>
                        <span class="ticket-status status-${ticket.status}">
                            ${ticket.status === 'open' ? '–û—Ç–∫—Ä—ã—Ç–æ' : 
                              ticket.status === 'closed' ? '–ó–∞–∫—Ä—ã—Ç–æ' : '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ'}
                        </span>
                    </div>
                    <div class="ticket-date">
                        ${formatDate(ticket.createdAt)} ‚Ä¢ ${getTicketTypeText(ticket.type)}
                    </div>
                    <p style="margin: 10px 0; line-height: 1.5;">${ticket.description}</p>
                    ${ticket.responses.length > 0 ? `
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #E2E8F0;">
                            <strong>–û—Ç–≤–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏:</strong>
                            <p style="margin-top: 5px; color: #4A5568;">${ticket.responses[0].message}</p>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function getTicketTypeText(type) {
            const types = {
                'technical': '–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞',
                'account': '–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º',
                'content': '–ñ–∞–ª–æ–±–∞ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç',
                'suggestion': '–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
                'other': '–î—Ä—É–≥–æ–µ'
            };
            return types[type] || type;
        }

        // –õ–∞–π–∫ –ø–æ—Å—Ç–∞
        function toggleLike(postId) {
            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const likeIndex = post.likes.indexOf(currentUser.id);
            
            if (likeIndex > -1) {
                post.likes.splice(likeIndex, 1);
            } else {
                post.likes.push(currentUser.id);
            }

            localStorage.setItem('social_posts', JSON.stringify(posts));
            loadPosts();
            updateStats();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
        function toggleComments(postId) {
            const commentsSection = document.getElementById(`comments-${postId}`);
            const isVisible = commentsSection.style.display !== 'none';
            
            document.querySelectorAll('.comments-section').forEach(section => {
                section.style.display = 'none';
            });
            
            if (!isVisible) {
                commentsSection.style.display = 'block';
            }
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        function addComment(postId, event) {
            event.preventDefault();
            
            const commentInput = document.getElementById(`comment-${postId}`);
            const content = commentInput.value.trim();
            
            if (!content) return;

            const post = posts.find(p => p.id === postId);
            if (!post) return;

            const newComment = {
                id: generateId(),
                author: currentUser,
                content,
                createdAt: new Date().toISOString()
            };

            post.comments.push(newComment);
            localStorage.setItem('social_posts', JSON.stringify(posts));
            
            commentInput.value = '';
            loadPosts();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const userPosts = posts.filter(post => post.author.id === currentUser.id);
            const totalLikes = userPosts.reduce((sum, post) => sum + post.likes.length, 0);
            const userPhotos = userImages[currentUser.id] || [];
            const totalPhotos = userPhotos.length;

            document.getElementById('statPosts').textContent = userPosts.length;
            document.getElementById('statPhotos').textContent = totalPhotos;
            document.getElementById('statLikes').textContent = totalLikes;

            document.getElementById('profileStatPosts').textContent = userPosts.length;
            document.getElementById('profileStatPhotos').textContent = totalPhotos;
            document.getElementById('profileStatLikes').textContent = totalLikes;
        }

        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
        function editProfile() {
            const newBio = prompt('–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ:', currentUser.bio || '');
            if (newBio !== null) {
                currentUser.bio = newBio;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                const userIndex = users.findIndex(u => u.id === currentUser.id);
                if (userIndex !== -1) {
                    users[userIndex] = currentUser;
                    localStorage.setItem('social_users', JSON.stringify(users));
                }
                
                localStorage.setItem('current_user', JSON.stringify(currentUser));
                updateUserInfo();
                showSuccess('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω! ‚úÖ');
            }
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (diff < 3600000) return `${Math.floor(diff / 60000)} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)} —á –Ω–∞–∑–∞–¥`;
            
            return date.toLocaleString('ru-RU', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }

        function formatTime(dateString) {
            const date = new Date(dateString);
            return date.toLocaleTimeString('ru-RU', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
        }

        function showError(message) {
            showMessage(message, 'error');
        }

        function showSuccess(message) {
            showMessage(message, 'success');
        }

        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.textContent = message;
            messageDiv.style.position = 'fixed';
            messageDiv.style.top = '20px';
            messageDiv.style.right = '20px';
            messageDiv.style.zIndex = '1000';
            messageDiv.style.maxWidth = '300px';
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 4000);
        }

        function showLogin() {
            loginPage.classList.remove('hidden');
            registerPage.classList.add('hidden');
            mainContent.classList.add('hidden');
            navbar.classList.add('hidden');
            loadSavedAccounts();
        }

        function showRegister() {
            loginPage.classList.add('hidden');
            registerPage.classList.remove('hidden');
            mainContent.classList.add('hidden');
            navbar.classList.add('hidden');
        }
    </script>
</body>
</html>
